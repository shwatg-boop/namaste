<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Namaste Shoutouts — Demo</title>
  <!-- Tailwind via CDN for quick demo -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 UMD + Babel for in-browser JSX transform (demo only) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const {useEffect, useMemo, useState} = React;

    /*************************
     * Helpers: storage + ids *
     *************************/
    const LS_KEYS = {
      USERS: "cameoNP_users_v1",
      SESSION: "cameoNP_session_v1",
      ORDERS: "cameoNP_orders_v1",
    };

    function load(key, fallback) {
      try {
        const v = localStorage.getItem(key);
        return v ? JSON.parse(v) : fallback;
      } catch {
        return fallback;
      }
    }

    function save(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }

    const uid = () => Math.random().toString(36).slice(2, 10);

    /*******************
     * Seed some demo data
     *******************/
    function ensureSeed() {
      const users = load(LS_KEYS.USERS, []);
      if (users.length) return;
      const demoInfluencers = [
        {
          id: uid(),
          role: "influencer",
          name: "Sushma Karki",
          email: "sushma@example.com",
          handle: "@sushma.karki",
          password: "demo",
          bio: "Actress | Dancer | For birthdays, roasts, pep talks",
          avatar:
            "https://images.unsplash.com/photo-1544006659-f0b21884ce1d?q=80&w=800&auto=format&fit=crop",
          categories: ["Actor", "Dance", "Entertainment"],
          platforms: ["instagram", "tiktok"],
          rates: { video: 2500, socialPost: 8000, liveCall: 3500 },
          socialAddOn: { instagram: 5000, tiktok: 4000, youtube: 7000 },
          minLeadDays: 2,
          city: "Kathmandu",
        },
        {
          id: uid(),
          role: "influencer",
          name: "Nischal Basnet",
          email: "nischal@example.com",
          handle: "@nischal.basnet",
          password: "demo",
          bio: "Director | Actor | Motivational shoutouts & roast requests",
          avatar:
            "https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?q=80&w=800&auto=format&fit=crop",
          categories: ["Actor", "Director"],
          platforms: ["instagram", "youtube"],
          rates: { video: 4000, socialPost: 12000, liveCall: 6000 },
          socialAddOn: { instagram: 6000, tiktok: 0, youtube: 9000 },
          minLeadDays: 3,
          city: "Lalitpur",
        },
      ];
      save(LS_KEYS.USERS, demoInfluencers);
      save(LS_KEYS.ORDERS, []);
    }

    /****************
     * UI Components *
     ****************/
    function Badge({ children }) {
      return (
        <span className="inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium">
          {children}
        </span>
      );
    }

    function Card({ children, className = "" }) {
      return (
        <div className={"rounded-2xl shadow-sm border bg-white p-4 " + className}>{children}</div>
      );
    }

    function PillTabs({ tabs, value, onChange }) {
      return (
        <div className="flex gap-2 bg-gray-100 rounded-full p-1 w-fit">
          {tabs.map((t) => (
            <button
              key={t.value}
              onClick={() => onChange(t.value)}
              className={"px-4 py-1.5 rounded-full text-sm " +
                (value === t.value ? "bg-white shadow border" : "text-gray-600")
              }
            >
              {t.label}
            </button>
          ))}
        </div>
      );
    }

    function Money({ v }) {
      const nf = React.useMemo(() => new Intl.NumberFormat("en-NP"), []);
      return <span>रु {nf.format(v)}</span>;
    }

    /**********************
     * Auth & Session hook *
     **********************/
    function useDB() {
      const [users, setUsers] = useState(() => load(LS_KEYS.USERS, []));
      const [orders, setOrders] = useState(() => load(LS_KEYS.ORDERS, []));
      const [session, setSession] = useState(() => load(LS_KEYS.SESSION, null));

      useEffect(() => save(LS_KEYS.USERS, users), [users]);
      useEffect(() => save(LS_KEYS.ORDERS, orders), [orders]);
      useEffect(() => save(LS_KEYS.SESSION, session), [session]);

      return { users, setUsers, orders, setOrders, session, setSession };
    }

    function AuthPanel({ db }) {
      const [mode, setMode] = useState("login");
      const [role, setRole] = useState("client");
      const [form, setForm] = useState({ name: "", email: "", handle: "", password: "" });

      const onSubmit = (e) => {
        e.preventDefault();
        if (mode === "login") {
          const user = db.users.find(
            (u) => u.email === form.email && u.password === form.password
          );
          if (!user) return alert("Invalid credentials. Try demo accounts in seed data.");
          db.setSession({ userId: user.id });
          return;
        }
        // sign up
        if (!form.email || !form.password || !form.name) return alert("Fill required fields.");
        if (db.users.some((u) => u.email === form.email)) return alert("Email already in use.");
        const nu = {
          id: uid(),
          role,
          name: form.name,
          email: form.email,
          handle: form.handle || ("@" + form.name.toLowerCase().replace(/\s+/g, ".")),
          password: form.password,
          bio: role === "influencer" ? "Tell clients what you offer." : undefined,
          avatar: "https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=800&auto=format&fit=crop",
          categories: role === "influencer" ? [] : undefined,
          platforms: role === "influencer" ? ["instagram", "tiktok"] : undefined,
          rates: role === "influencer" ? { video: 2000, socialPost: 5000, liveCall: 3000 } : undefined,
          socialAddOn: role === "influencer" ? { instagram: 3000, tiktok: 2000, youtube: 4000 } : undefined,
          minLeadDays: role === "influencer" ? 2 : undefined,
          city: role === "influencer" ? "Kathmandu" : undefined,
        };
        db.setUsers([...db.users, nu]);
        db.setSession({ userId: nu.id });
      };

      return (
        <Card className="max-w-xl w-full">
          <div className="flex items-center justify-between mb-3">
            <h2 className="text-xl font-semibold">{mode === "login" ? "Login" : "Create account"}</h2>
            <PillTabs
              value={mode}
              onChange={setMode}
              tabs={[
                { value: "login", label: "Login" },
                { value: "signup", label: "Sign up" },
              ]}
            />
          </div>
          {mode === "signup" && (
            <div className="mb-3">
              <PillTabs
                value={role}
                onChange={setRole}
                tabs={[
                  { value: "client", label: "Client" },
                  { value: "influencer", label: "Influencer/Celebrity" },
                ]}
              />
            </div>
          )}
          <form onSubmit={onSubmit} className="grid gap-3">
            {mode === "signup" && (
              <>
                <div className="grid gap-1">
                  <label className="text-sm">Full name*</label>
                  <input className="border rounded-xl p-2" value={form.name} onChange={(e)=>setForm({...form, name:e.target.value})} />
                </div>
                <div className="grid gap-1">
                  <label className="text-sm">Public handle {role === "influencer" && <span className="text-gray-500">(e.g. @name)</span>}</label>
                  <input className="border rounded-xl p-2" value={form.handle} onChange={(e)=>setForm({...form, handle:e.target.value})} />
                </div>
              </>
            )}
            <div className="grid gap-1">
              <label className="text-sm">Email*</label>
              <input className="border rounded-xl p-2" type="email" value={form.email} onChange={(e)=>setForm({...form, email:e.target.value})} />
            </div>
            <div className="grid gap-1">
              <label className="text-sm">Password*</label>
              <input className="border rounded-xl p-2" type="password" value={form.password} onChange={(e)=>setForm({...form, password:e.target.value})} />
            </div>
            <button className="mt-2 rounded-2xl bg-black text-white px-4 py-2">{mode === "login" ? "Login" : "Create account"}</button>
            {mode === "login" && (
              <p className="text-xs text-gray-500">Demo influencers (password: demo): sushma@example.com, nischal@example.com</p>
            )}
          </form>
        </Card>
      );
    }

    /*******************
     * Influencer Panel *
     *******************/
    function InfluencerDashboard({ db, me }) {
      const [profile, setProfile] = useState(me);

      useEffect(() => { setProfile(me); }, [me.id]);

      const myOrders = db.orders.filter((o) => o.influencerId === me.id);

      const updateProfile = () => {
        db.setUsers(db.users.map((u) => (u.id === me.id ? profile : u)));
        alert("Profile updated");
      };

      const setOrderStatus = (orderId, status) => {
        db.setOrders(db.orders.map((o) => (o.id === orderId ? { ...o, status } : o)));
      };

      return (
        <div className="grid lg:grid-cols-3 gap-4">
          <Card className="lg:col-span-2">
            <h3 className="text-lg font-semibold mb-3">Profile & Rates</h3>
            <div className="grid sm:grid-cols-2 gap-3">
              <div className="grid gap-1">
                <label className="text-sm">Display name</label>
                <input className="border rounded-xl p-2" value={profile.name} onChange={(e)=>setProfile({...profile, name:e.target.value})} />
              </div>
              <div className="grid gap-1">
                <label className="text-sm">Handle</label>
                <input className="border rounded-xl p-2" value={profile.handle} onChange={(e)=>setProfile({...profile, handle:e.target.value})} />
              </div>
              <div className="grid gap-1 sm:col-span-2">
                <label className="text-sm">Bio</label>
                <textarea className="border rounded-xl p-2" rows="3" value={profile.bio||""} onChange={(e)=>setProfile({...profile, bio:e.target.value})} />
              </div>
              <div className="grid gap-1">
                <label className="text-sm">City</label>
                <input className="border rounded-xl p-2" value={profile.city||""} onChange={(e)=>setProfile({...profile, city:e.target.value})} />
              </div>
              <div className="grid gap-1">
                <label className="text-sm">Categories (comma separated)</label>
                <input className="border rounded-xl p-2" value={(profile.categories||[]).join(", ")} onChange={(e)=>setProfile({...profile, categories:e.target.value.split(",").map(s=>s.trim()).filter(Boolean)})} />
              </div>
              <div className="grid grid-cols-3 gap-3 sm:col-span-2">
                <div>
                  <label className="text-sm">Video rate</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.rates?.video||0} onChange={(e)=>setProfile({...profile, rates:{...profile.rates, video:Number(e.target.value)}})} />
                </div>
                <div>
                  <label className="text-sm">Social post</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.rates?.socialPost||0} onChange={(e)=>setProfile({...profile, rates:{...profile.rates, socialPost:Number(e.target.value)}})} />
                </div>
                <div>
                  <label className="text-sm">Live call</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.rates?.liveCall||0} onChange={(e)=>setProfile({...profile, rates:{...profile.rates, liveCall:Number(e.target.value)}})} />
                </div>
              </div>
              <div className="grid sm:grid-cols-3 gap-3 sm:col-span-2">
                <div>
                  <label className="text-sm">Add‑on: Instagram post</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.socialAddOn?.instagram||0} onChange={(e)=>setProfile({...profile, socialAddOn:{...profile.socialAddOn, instagram:Number(e.target.value)}})} />
                </div>
                <div>
                  <label className="text-sm">Add‑on: TikTok video</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.socialAddOn?.tiktok||0} onChange={(e)=>setProfile({...profile, socialAddOn:{...profile.socialAddOn, tiktok:Number(e.target.value)}})} />
                </div>
                <div>
                  <label className="text-sm">Add‑on: YouTube mention</label>
                  <input className="border rounded-xl p-2 w-full" type="number" value={profile.socialAddOn?.youtube||0} onChange={(e)=>setProfile({...profile, socialAddOn:{...profile.socialAddOn, youtube:Number(e.target.value)}})} />
                </div>
              </div>
              <div className="grid gap-1">
                <label className="text-sm">Minimum lead time (days)</label>
                <input className="border rounded-xl p-2 w-full" type="number" value={profile.minLeadDays||0} onChange={(e)=>setProfile({...profile, minLeadDays:Number(e.target.value)})} />
              </div>
            </div>
            <div className="mt-3 flex gap-2">
              <button onClick={updateProfile} className="rounded-2xl bg-black text-white px-4 py-2">Save</button>
            </div>
          </Card>

          <Card>
            <h3 className="text-lg font-semibold mb-3">Requests</h3>
            <div className="grid gap-3">
              {myOrders.length === 0 && <p className="text-sm text-gray-500">No requests yet.</p>}
              {myOrders.map((o) => (
                <div key={o.id} className="border rounded-xl p-3">
                  <div className="flex items-center justify-between">
                    <div className="text-sm">#{o.id.slice(0,6)} • <Badge>{o.status}</Badge></div>
                    <div className="text-sm font-medium"><Money v={o.price} /></div>
                  </div>
                  <div className="mt-2 text-sm">
                    <div>From: {getUserName(db, o.clientId)}</div>
                    <div>Delivery: {o.delivery === 'video' ? 'Video shoutout' : o.delivery === 'social' ? "Social post ("+o.selectedPlatform+")" : "Live call ("+o.callDuration+" min)"}</div>
                    {o.addOnPost && <div>Add‑on: Post to my social</div>}
                    <div>Recipient: {o.recipientName} • Occasion: {o.occasion}</div>
                    <div>Due by: {new Date(o.dueDate).toDateString()}</div>
                    <div className="mt-1 text-gray-600">Instructions: {o.instructions}</div>
                  </div>
                  <div className="mt-2 flex gap-2">
                    {o.status === "pending" && (
                      <>
                        <button onClick={()=>setOrderStatus(o.id, "accepted")} className="rounded-xl bg-green-600 text-white px-3 py-1 text-sm">Accept</button>
                        <button onClick={()=>setOrderStatus(o.id, "declined")} className="rounded-xl bg-red-600 text-white px-3 py-1 text-sm">Decline</button>
                      </>
                    )}
                    {o.status === "accepted" && (
                      <button onClick={()=>setOrderStatus(o.id, "delivered")} className="rounded-xl bg-blue-600 text-white px-3 py-1 text-sm">Mark Delivered</button>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </Card>
        </div>
      );
    }

    /****************
     * Client Panel *
     ****************/
    function getUserName(db, id) { return db.users.find((u)=>u.id===id)?.name || "Unknown"; }

    function ClientDashboard({ db, me }) {
      const [query, setQuery] = useState("");
      const [category, setCategory] = useState("all");
      const influencers = db.users.filter((u) => u.role === "influencer");

      const filtered = influencers.filter((u) => {
        const matchText = (u.name + " " + u.handle + " " + (u.bio || "") + " " + (u.categories||[]).join(" ")).toLowerCase();
        const passQuery = matchText.includes(query.toLowerCase());
        const passCat = category === "all" || (u.categories||[]).map(c=>c.toLowerCase()).includes(category);
        return passQuery && passCat;
      });

      return (
        <div className="grid lg:grid-cols-3 gap-4">
          <Card className="lg:col-span-2">
            <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-3">
              <h3 className="text-lg font-semibold">Browse influencers</h3>
              <div className="flex gap-2">
                <input placeholder="Search name, handle, bio..." className="border rounded-2xl px-3 py-2 w-full sm:w-72" value={query} onChange={(e)=>setQuery(e.target.value)} />
                <select className="border rounded-2xl px-3 py-2" value={category} onChange={(e)=>setCategory(e.target.value)}>
                  <option value="all">All categories</option>
                  {[...new Set(influencers.flatMap((i)=>i.categories||[]))].map((c)=> (
                    <option key={c} value={c.toLowerCase()}>{c}</option>
                  ))}
                </select>
              </div>
            </div>
            <div className="grid md:grid-cols-2 gap-4">
              {filtered.map((u) => (
                <InfluencerCard key={u.id} db={db} me={me} u={u} />
              ))}
              {filtered.length === 0 && <p className="text-sm text-gray-500">No matches.</p>}
            </div>
          </Card>

          <Card>
            <h3 className="text-lg font-semibold mb-3">My Orders</h3>
            <div className="grid gap-3">
              {db.orders.filter((o)=>o.clientId===me.id).map((o)=> (
                <div key={o.id} className="border rounded-xl p-3">
                  <div className="flex items-center justify-between">
                    <div className="text-sm">#{o.id.slice(0,6)} • <Badge>{o.status}</Badge></div>
                    <div className="text-sm font-medium"><Money v={o.price} /></div>
                  </div>
                  <div className="mt-1 text-sm">{getUserName(db, o.influencerId)} • {o.delivery}</div>
                  <div className="text-xs text-gray-600">Due by {new Date(o.dueDate).toDateString()}</div>
                </div>
              ))}
              {db.orders.filter((o)=>o.clientId===me.id).length===0 && <p className="text-sm text-gray-500">You have no orders yet.</p>}
            </div>
          </Card>
        </div>
      );
    }

    function InfluencerCard({ db, me, u }) {
      const [open, setOpen] = useState(false);
      return (
        <div className="border rounded-2xl overflow-hidden">
          <div className="p-4 flex gap-3">
            <img src={u.avatar} alt={u.name} className="w-16 h-16 rounded-xl object-cover" />
            <div className="flex-1">
              <div className="flex items-center gap-2">
                <div className="font-semibold">{u.name}</div>
                <Badge>{u.handle}</Badge>
              </div>
              <div className="text-sm text-gray-600">{u.bio}</div>
              <div className="mt-1 flex flex-wrap gap-1">
                {(u.categories||[]).map((c)=> <Badge key={c}>{c}</Badge>)}
              </div>
            </div>
          </div>
          <div className="border-t p-3 grid gap-2 text-sm">
            <div className="flex items-center justify-between"><span>Video shoutout</span><span className="font-medium"><Money v={u.rates?.video||0} /></span></div>
            <div className="flex items-center justify-between"><span>Social media post</span><span className="font-medium"><Money v={u.rates?.socialPost||0} /></span></div>
            <div className="flex items-center justify-between"><span>Live call</span><span className="font-medium"><Money v={u.rates?.liveCall||0} /></span></div>
            <button onClick={()=>setOpen(true)} className="mt-2 rounded-xl bg-black text-white px-4 py-2 text-sm">Request</button>
          </div>
          {open && (
            <RequestModal db={db} me={me} u={u} onClose={()=>setOpen(false)} />
          )}
        </div>
      );
    }

    function RequestModal({ db, me, u, onClose }) {
      const [delivery, setDelivery] = useState("video");
      const [selectedPlatform, setSelectedPlatform] = useState(u.platforms?.[0] || "instagram");
      const [callDuration, setCallDuration] = useState(10);
      const [addOnPost, setAddOnPost] = useState(false);
      const [occasion, setOccasion] = useState("");
      const [recipientName, setRecipientName] = useState("");
      const [instructions, setInstructions] = useState("");
      const [leadDays, setLeadDays] = useState(u.minLeadDays || 2);

      const basePrice = React.useMemo(() => {
        if (delivery === "video") return u.rates?.video || 0;
        if (delivery === "social") return u.rates?.socialPost || 0;
        if (delivery === "call") return u.rates?.liveCall || 0;
        return 0;
      }, [delivery, u]);

      const addOnPrice = React.useMemo(() => {
        if (!addOnPost) return 0;
        const map = u.socialAddOn || {};
        return map[selectedPlatform] || 0;
      }, [addOnPost, selectedPlatform, u]);

      const total = basePrice + addOnPrice;

      const createOrder = () => {
        if (!me) return alert("Please login as a client.");
        if (!recipientName) return alert("Recipient name is required.");
        const due = new Date();
        due.setDate(due.getDate() + Number(leadDays || 2));
        const o = {
          id: uid(),
          clientId: me.id,
          influencerId: u.id,
          status: "pending",
          occasion,
          recipientName,
          instructions,
          delivery: delivery === "video" ? "video" : delivery === "social" ? "social" : "call",
          selectedPlatform: delivery === "social" ? selectedPlatform : undefined,
          callDuration: delivery === "call" ? Number(callDuration) : undefined,
          addOnPost: Boolean(addOnPost && delivery !== "call"),
          price: total,
          createdAt: new Date().toISOString(),
          dueDate: due.toISOString(),
        };
        db.setOrders([o, ...db.orders]);
        onClose();
        alert("Request submitted! The influencer will accept or decline.");
      };

      return (
        <div className="fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-2xl max-w-xl w-full p-4">
            <div className="flex items-start justify-between">
              <div>
                <div className="font-semibold">Request: {u.name}</div>
                <div className="text-xs text-gray-600">Minimum lead: {u.minLeadDays || 0} days</div>
              </div>
              <button onClick={onClose} className="text-gray-500">✕</button>
            </div>
            <div className="mt-3 grid gap-3">
              <div className="grid gap-1">
                <label className="text-sm">Delivery type</label>
                <div className="flex gap-2">
                  {[
                    {v:"video", l:"Video shoutout"},
                    {v:"social", l:"Social media post"},
                    {v:"call", l:"Live call"},
                  ].map((opt)=> (
                    <button key={opt.v} onClick={()=>setDelivery(opt.v)} className={"px-3 py-1.5 rounded-full border text-sm " + (delivery===opt.v? 'bg-black text-white' : '')}>{opt.l}</button>
                  ))}
                </div>
              </div>

              {delivery === "social" && (
                <div className="grid sm:grid-cols-2 gap-3">
                  <div className="grid gap-1">
                    <label className="text-sm">Platform</label>
                    <select className="border rounded-xl px-3 py-2" value={selectedPlatform} onChange={(e)=>setSelectedPlatform(e.target.value)}>
                      {(u.platforms||["instagram","tiktok","youtube"]).map((p)=> (
                        <option key={p} value={p}>{p}</option>
                      ))}
                    </select>
                  </div>
                  <div className="grid gap-1">
                    <label className="text-sm">Add-on: post to influencer's social?</label>
                    <select className="border rounded-xl px-3 py-2" value={addOnPost? 'yes':'no'} onChange={(e)=>setAddOnPost(e.target.value==='yes')}>
                      <option value="no">No</option>
                      <option value="yes">Yes (+ add-on rate)</option>
                    </select>
                  </div>
                </div>
              )}

              {delivery === "call" && (
                <div className="grid gap-1">
                  <label className="text-sm">Call duration (minutes)</label>
                  <input className="border rounded-xl p-2 w-36" type="number" value={callDuration} onChange={(e)=>setCallDuration(e.target.value)} />
                </div>
              )}

              <div className="grid sm:grid-cols-2 gap-3">
                <div className="grid gap-1">
                  <label className="text-sm">Recipient name*</label>
                  <input className="border rounded-xl p-2" value={recipientName} onChange={(e)=>setRecipientName(e.target.value)} />
                </div>
                <div className="grid gap-1">
                  <label className="text-sm">Occasion</label>
                  <input className="border rounded-xl p-2" placeholder="Birthday, pep talk, roast..." value={occasion} onChange={(e)=>setOccasion(e.target.value)} />
                </div>
              </div>
              <div className="grid gap-1">
                <label className="text-sm">Instructions / script notes</label>
                <textarea className="border rounded-xl p-2" rows="3" value={instructions} onChange={(e)=>setInstructions(e.target.value)} />
              </div>
              <div className="grid gap-1 w-56">
                <label className="text-sm">Lead time (days)</label>
                <input className="border rounded-xl p-2" type="number" value={leadDays} onChange={(e)=>setLeadDays(e.target.value)} />
              </div>

              <div className="border rounded-xl p-3 bg-gray-50">
                <div className="flex items-center justify-between text-sm">
                  <span>Base price</span>
                  <span><Money v={basePrice} /></span>
                </div>
                {delivery !== 'call' && addOnPost && (
                  <div className="flex items-center justify-between text-sm">
                    <span>Add‑on ({selectedPlatform})</span>
                    <span><Money v={addOnPrice} /></span>
                  </div>
                )}
                <div className="mt-2 flex items-center justify-between font-semibold">
                  <span>Total</span>
                  <span><Money v={total} /></span>
                </div>
              </div>

              <div className="flex items-center justify-between">
                <button onClick={onClose} className="px-4 py-2 rounded-xl border">Cancel</button>
                <button onClick={createOrder} className="px-4 py-2 rounded-xl bg-black text-white">Submit request</button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    /****************
     * Top-level App *
     ****************/
    function App() {
      ensureSeed();
      const db = useDB();
      const me = db.users.find((u) => u.id === (db.session && db.session.userId)) || null;
      const [tab, setTab] = useState("home");

      const logout = () => db.setSession(null);

      return (
        <div className="min-h-screen bg-gray-50">
          <header className="sticky top-0 z-40 backdrop-blur bg-white/80 border-b">
            <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
              <div className="flex items-center gap-2">
                <span className="text-xl font-bold">Namaste Shoutouts</span>
                <Badge>Beta</Badge>
              </div>
              <div className="flex items-center gap-3">
                <button onClick={()=>setTab("home")} className={"text-sm " + (tab==='home'?'font-semibold':'')}>Home</button>
                <button onClick={()=>setTab("explore")} className={"text-sm " + (tab==='explore'?'font-semibold':'')}>Explore</button>
                {me && me.role === 'influencer' && (
                  <button onClick={()=>setTab("influencer")} className={"text-sm " + (tab==='influencer'?'font-semibold':'')}>My Dashboard</button>
                )}
                {me && me.role === 'client' && (
                  <button onClick={()=>setTab("client")} className={"text-sm " + (tab==='client'?'font-semibold':'')}>My Dashboard</button>
                )}
                {!me ? (
                  <button onClick={()=>setTab("auth")} className={"text-sm " + (tab==='auth'?'font-semibold':'')}>Login / Sign up</button>
                ) : (
                  <div className="flex items-center gap-2">
                    <Badge>{me.role}</Badge>
                    <span className="text-sm">{me.name}</span>
                    <button onClick={logout} className="text-sm underline">Logout</button>
                  </div>
                )}
              </div>
            </div>
          </header>

          <main className="max-w-6xl mx-auto px-4 py-6 grid gap-6">
            {tab === "home" && (
              <div className="grid lg:grid-cols-2 gap-4 items-center">
                <div className="space-y-4">
                  <h1 className="text-3xl font-bold">Book personalised video shoutouts, social posts, or live calls from Nepali stars</h1>
                  <p className="text-gray-600">A simple Nepal-first alternative to Cameo. Creators set their own rates. Clients request in minutes. Everything here runs 100% in your browser for this MVP demo.</p>
                  <div className="flex gap-2">
                    <button onClick={()=>setTab("explore")} className="rounded-2xl bg-black text-white px-4 py-2">Explore influencers</button>
                    <button onClick={()=>setTab("auth")} className="rounded-2xl border px-4 py-2">Login / Sign up</button>
                  </div>
                  <ul className="text-sm text-gray-700 list-disc ml-5">
                    <li>Rates in NPR with optional add‑on for posting on influencer socials</li>
                    <li>Delivery types: video shoutout, social post, live call</li>
                    <li>Influencer acceptance flow (accept/decline, mark delivered)</li>
                  </ul>
                </div>
                <Card>
                  <h3 className="text-lg font-semibold mb-3">How it works</h3>
                  <ol className="text-sm grid gap-2 list-decimal ml-4">
                    <li>Sign up as <strong>Client</strong> or <strong>Influencer</strong></li>
                    <li>Influencers set profile, rates, and minimum lead time</li>
                    <li>Clients pick an influencer, choose delivery type & add‑ons, and submit a request</li>
                    <li>Influencer accepts/declines and delivers (demo uses status only)</li>
                  </ol>
                </Card>
              </div>
            )}

            {tab === "auth" && <AuthPanel db={db} />}
            {tab === "explore" && (db.session && me?.role === 'client' ? <ClientDashboard db={db} me={me} /> : <ExploreLoggedOut db={db} onLogin={()=>setTab('auth')} />)}
            {tab === "influencer" && me && me.role === 'influencer' && <InfluencerDashboard db={db} me={me} />}
            {tab === "client" && me && me.role === 'client' && <ClientDashboard db={db} me={me} />}
          </main>

          <footer className="max-w-6xl mx-auto px-4 py-8 text-xs text-gray-500">
            <div className="flex flex-wrap items-center justify-between gap-2">
              <span>© {(new Date()).getFullYear()} Namaste Shoutouts (Demo)</span>
              <div className="flex gap-3">
                <span>Terms (demo)</span>
                <span>Privacy (demo)</span>
              </div>
            </div>
          </footer>
        </div>
      );
    }

    function ExploreLoggedOut({ db, onLogin }) {
      const influencers = db.users.filter((u)=>u.role==='influencer');
      return (
        <div className="grid gap-4">
          <div className="flex items-center justify-between">
            <h3 className="text-lg font-semibold">Featured influencers</h3>
            <button onClick={onLogin} className="text-sm underline">Login to request</button>
          </div>
          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
            {influencers.map((u)=> (
              <div key={u.id} className="border rounded-2xl p-3">
                <div className="flex gap-3">
                  <img src={u.avatar} className="w-14 h-14 rounded-xl object-cover" />
                  <div>
                    <div className="font-medium">{u.name}</div>
                    <div className="text-xs text-gray-600">{u.bio}</div>
                  </div>
                </div>
                <div className="mt-2 text-sm">Video <span className="font-medium"><Money v={u.rates?.video||0} /></span></div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // Mount App
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
